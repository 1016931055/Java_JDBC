```java
作业规范【必读】

命名要求：
	1. 类名，接口名，枚举名，注解名使用大驼峰
	2. 变量名，方法名，包名均使用小驼峰
	3. 常量名全大写，多个单词下划线分割
	4. 名字要见名知意，如果不知道对应的英文，可以使用拼音代替。不可使用无意义字符
  

代码规范：
	格式要良好，使用IDEA格式化缩进（快捷键：Ctrl+Alt+L）

    
答题规范：
	1. 每道题完整代码请贴入对应题目中的代码区。
    2. 如果有运行结果的，请把代码运行结果放到文档中
  

作业提交：
   将当前文件所在文件夹压缩后，以自己的名字命名提交
```





# 【反射】

## 题目1

1. 请定义以下类：

   ```java
     public class Student{
   
         private String name;
         private int age;
         //公有、无参构造
         //公有、全参构造
         //公有、get/set方法
         //......
         //普通成员方法
         public void show(){
            System.out.println(“大家好，我叫：” + name + “ 我今年：” + age + “ 岁”);
         }
     }
   ```
   

   
2. 请编写main()方法：

​       1). 使用反射获取Student的Class对象。

~~~java
Class studentClass = Student.class;
~~~

​       2). 获取 “公有、全参构造方法”；

~~~java
Constructor c = studentClass.getConstructor(String.class, int.class);
~~~

​       3). 调用 “公有、全参构造方法”传入：“柳岩”,17两个参数。

~~~java
Student stu = (Student) c.newInstance("柳岩",17);
~~~

​       4). 反射获取show()方法

~~~java
Method m = studentClass.getMethod("show");
~~~

​       5). 调用show()方法

~~~java
m.invoke( stu );
~~~



**参考答案：**

   ~~~java
public class Student {

    private String name;
    private int age;

    public void show(){
        System.out.println("大家好，我叫：" + name + " 我今年：" + age + " 岁");
    }

    public Student() {
    }

    public Student(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }
}
   ~~~

~~~java
import java.lang.reflect.Constructor;
import java.lang.reflect.Method;

public class TestStudent {

    public static void main(String[] args) throws Exception {
        //使用反射获取Student的Class对象
        Class clazz = Student.class;
        
        //获取 “公有、全参构造方法”
        Constructor con = clazz.getDeclaredConstructor(String.class,int.class);
        
        //调用 “公有、全参构造方法”传入：“柳岩”,17两个参数
        Student stu = (Student) con.newInstance("柳岩",17);
        
        //反射获取show()方法
        Method show = clazz.getDeclaredMethod("show");
        
        //调用show()方法
        show.invoke(stu);
    }
}
~~~





## 题目2

需求：

1. 现有集合：ArrayList\<Integer>list = new ArrayList(); 
2. 利用反射机制在这个泛型为Integer的ArrayList中存放一个String类型的对象。

~~~java
ArrayList<Integer>list = new ArrayList(); 
list.add("字符串");//泛型：限定的集合中的元素类型必须为Integer类型

//泛型：是编译时期的技术 （仅在编写代码时有用，编译生成.class文件后，泛型无效）

//反射技术：是基于.class文件进行操作的


//ArrayList类源代码：
public class ArrayList extends ... implements ....{
    ....
        
    public void add(Object el){
        .....
    }    
        
    ....    
}
~~~

**参考答案**

```java
public class Test02 {
    /*
     * 2.ArrayList<Integer> list = new ArrayList<Integer>();
         在这个泛型为Integer的ArrayList中存放一个String类型的对象。
     */
    public static void main(String[] args) throws Exception {
        // 创建集合
        ArrayList<Integer> list = new ArrayList<Integer>();
        list.add(111);
        list.add(222);
        list.add(333);

        // 通过反射获得Class对象
        // Class.forName("java.util.ArrayList");
        Class c = list.getClass();
        
        // 获得add方法对象
        Method addM = c.getMethod("add", Object.class);
        
        // 通过反射调用list对象的add方法
        addM.invoke(list, "aaaa");
        
        System.out.println(list);
    }
}
```





## 题目3

需求：按要求完成下面两个方法的方法体 

1. 写一个方法，此方法可将obj对象中名为propertyName的属性的值设置为value. 
   `public void setProperty(Object obj, String propertyName, Object value){}`
   - Object  obj  ：  对象 （实例化的对象）
   - String  propertyName ： 属性名（成员变量名）
   - Object  value ： 属性值（成员变量的数据值）
   - 方法的功能： 给obj对象中的propertyName属性，赋值为value
2. 写一个方法，此方法可以获取obj对象中名为propertyName的属性的值 
   `public Object getProperty(Object obj, String propertyName){}` 
   - Object  obj ： 对象 （实例化的对象）
   - String  propertyName ： 属性名（成员变量名）
   - 方法的功能： 获取obj对象中的propertyName属性的值

> 使用反射技术实现。 使用Field对象给成员变量赋值、取值

~~~java
//在反射技术中，获取成员变量：
Field  f = Class对象.getField("成员变量名"); //获取public修饰的成员变量

Field  f = Class对象.getDeclaredField("成员变量名"); //获取所有的成员变量（包含private）

//在反射技术中，给成员变量赋值： （通常成员变量都是private修饰）
//1、Class对象.getDeclaredField("成员变量名") 获取私有成员变量
//2、暴力破解（去除当前权限检查）  setAccessible(true)
//3、set(Object obj, Object value) 
//      obj： 实例化的对象   （构造器对象）
//      value： 要赋的值

//获取成员变量的值：
//1、暴力破解（去除当前权限检查）  setAccessible(true)
//2、获取成员变量的值   Object get(Object obj)     obj：实例化对象  

~~~

答案：

```java
class Student {
    private int age;
    private String name;
    public Student() {

    }

    public Student(int age, String name) {
        super();
        this.age = age;
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return "Student [age=" + age + ", name=" + name + "]";
    }
}




public class Test03 {
    public static void main(String[] args) throws Exception {
        Student student = new Student(30,"张三");
        
        //调用setProperty方法，给student对象中的age成员变量，赋值：25
        setProperty(student, "age", 25);
        System.out.println(student);

        Object obj = getProperty(student, "name");
        System.out.println(obj);
    }

    //给对象obj的名字为propertyName的属性设置为value
    public static void setProperty(Object obj, String propertyName, Object value) throws Exception{
        //1.获取obj的字节码对象
        Class clazz = obj.getClass();
        
        //2.获取propertyName属性对应的Field对象
        Field propertyNameField = clazz.getDeclaredField(propertyName);
        
        //3.设置成可访问的
        propertyNameField.setAccessible(true);//当不确定是否为私有变量时（可以添加）
        
        //4.调用set方法给对象赋值
        propertyNameField.set(obj, value);
    }
    
    
    //给对象obj的名字为propertyName的属性设置为value
    public static Object getProperty(Object obj, String propertyName) throws Exception{
        //1.获取obj的字节码对象
        Class clazz = obj.getClass();
        
        //2.获取propertyName属性对应的Field对象
        Field propertyNameField = clazz.getDeclaredField(propertyName);
        
        //3.设置成可访问的
        propertyNameField.setAccessible(true);
        
        //4.调用get方法获取该对象对应属性的值
        return propertyNameField.get(obj);
    }
}
```







## 题目4

需求：

1. 定义一个Person类，包含私有属性name、age，getXxx和setXxx方法和有参满参构造方法。
2. 使用反射的方式创建一个实例、调用构造函数初始化name、age。使用反射方式调用setName方法对姓名进行设置，不使用setAge方法直接使用反射方式对age赋值。

答案：

```java
class Person {
    private int age;
    private String name;
    public Person() {
    }
    public Person(int age, String name) {
        super();
        this.age = age;
        this.name = name;
    }
    public int getAge() {
        return age;
    }
    public void setAge(int age) {
        this.age = age;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    @Override
    public String toString() {
        return "Person [age=" + age + ", name=" + name + "]";
    }
}




public class Test04 {
    public static void main(String[] args) throws Exception, SecurityException {
        //1.获取Person类的字节码对象
        Class clazz = Person.class;
        
        //2.利用反射获取有参构造方法
        Constructor constructor  = clazz.getConstructor(int.class,String.class);
        
        //3.调用构造方法,给属性初始化
        Person person =  (Person)constructor.newInstance(30,"灭绝师太");
        System.out.println(person);
        
        //4.使用反射方式调用setName方法对名称进行设置
        Method setNameMethod = clazz.getMethod("setName", String.class);
        setNameMethod.invoke(person, "张三丰");
        
        //5.不使用setAge方法直接使用反射方式对age赋值。
        Field ageField = clazz.getDeclaredField("age");
        ageField.setAccessible(true);
        ageField.set(person, 50);
        
        System.out.println(person);
    }
}
```







## 题目5

需求：已知一个类，定义如下 

```java
public class DemoClass { 
	public void run() { 
		System.out.println("welcome to heima!"); 
	} 
}
```

(1) 写一个Properties格式的配置文件，配置文件内容如下： 

 config.properties

```
className=com.itcast.test07.DemoClass
```

(2)写一个程序，读取这个Properties配置文件，获得类的完整名称并加载这个类， 

(3)用反射的方式运行run方法。 

答案：

```java
public class Test05 {
    public static void main(String[] args) throws Exception {
        // 创建集合对象
        Properties props = new Properties();

        FileInputStream fis = new FileInputStream("config.properties");
        // 从属性文件中加载数据
        props.load(fis);
        
        // 获得类全名
        String className = (String) props.get("className");
        System.out.println(className);
        
        // 获得Class对象
        Class clazz = Class.forName(className);
        
        //利用反射创建一个对象
        Object obj = clazz.newInstance();//Class对象中提供的newInstance()方法：已过时
        
        //利用反射获取run方法
        Method runMethod = clazz.getMethod("run");
        //利用反射调用run方法
        runMethod.invoke(obj);
        fis.close();
    }
}
```









# 【注解】

## 题目6

请编写程序，模拟JUnit的@Test注解

答案：

~~~java
import java.lang.reflect.Method;

public class TestDemo {
    @MyTest
    public void run1(){
        System.out.println("===run1===");
    }

    public void run2(){
        System.out.println("===run2===");
    }

    public void run3(){
        System.out.println("===run3===");
    }

    @MyTest
    public void run4(){
        System.out.println("===run4===");
    }

    // 自己模拟那个启动按钮。只启动有注解的方法
    public static void main(String[] args) throws Exception {
        TestDemo t = new TestDemo();
        // 扫描所有的方法对象，看方法上是否有注解，有就触发它。
        Class clazz = TestDemo.class;
        // 获取全部的方法
        Method[] methods = clazz.getDeclaredMethods();
        // 遍历全部方法
        for(Method mt : methods){
            // 判断这个方法是否有MyTest注解，有就触发它执行
            if(mt.isAnnotationPresent(MyTest.class)){
                // 触发这个方法执行！
                mt.invoke(t);
            }
        }
    }
}
~~~







